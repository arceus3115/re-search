(()=>{"use strict";var t={60:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,s){function a(t){try{c(o.next(t))}catch(t){s(t)}}function i(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,i)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.renderLandingPage=i,e.renderApp=c,e.showAuthorWorksModal=function(t,e,n){const o=document.getElementById("author-works-modal"),r=document.getElementById("modal-author-name"),s=document.getElementById("modal-author-institution"),a=document.getElementById("modal-works-list");o&&r&&s&&a&&(r.textContent=`Works by ${t}`,s.textContent=e,a.innerHTML=n,o.style.display="flex")};const r=n(806),s=n(966),a=n(807);function i(t){t.innerHTML='\n        <div class="landing-page">\n            <h1>Research Network Hub</h1>\n            <p>Welcome to your central hub for academic research tools.</p>\n            <h2>Available Tools</h2>\n            <div class="tool-list">\n                <button class="tool-button" data-tool="search">Academic Paper Search</button>\n                <button class="tool-button" data-tool="pcsas">PCSAS</button>\n                <button class="tool-button" data-tool="cross-search">Cross-Search Universities</button>\n            </div>\n            <h2>Your Network Dashboard</h2>\n            <div id="network-animation-placeholder" style="height: 300px; background-color: #f0f0f0; display: flex; justify-content: center; align-items: center; border-radius: 8px;">\n                <p>Cool Network Animation Placeholder</p>\n            </div>\n        </div>\n    ',document.querySelectorAll(".tool-button").forEach(e=>{e.addEventListener("click",e=>{const n=e.target.dataset.tool;n&&c(t,n)})})}function c(t){return o(this,arguments,void 0,function*(t,e="search"){t.innerHTML='\n        <div class="app-header">\n            <div class="logo">Research Network</div>\n            <div class="tabs">\n                <button class="tab-button" data-tab="search">Academic Paper Search</button>\n                <button class="tab-button" data-tab="pcsas">PCSAS</button>\n                <button class="tab-button" data-tab="cross-search">Cross-Search Universities</button>\n            </div>\n        </div>\n        <div class="app-container">\n            <div id="tab-content-search" class="tab-content"></div>\n            <div id="tab-content-pcsas" class="tab-content"></div>\n            <div id="tab-content-cross-search" class="tab-content"></div>\n        </div>\n    ';const n=document.querySelector(".app-header .logo");n&&(n.style.cursor="pointer",n.addEventListener("click",()=>{i(t)})),(0,r.renderSearchTab)(),(0,s.renderPcsasTab)(),(0,a.renderCrossSearchTab)(),document.querySelectorAll(".tab-button").forEach(t=>{t.addEventListener("click",t=>{const e=t.target.dataset.tab;if(document.querySelectorAll(".tab-content").forEach(t=>{t.style.display="none"}),document.querySelectorAll(".tab-button").forEach(t=>{t.classList.remove("active")}),e){const n=document.getElementById(`tab-content-${e}`);n&&(n.style.display="block"),t.target.classList.add("active")}})});const o=document.querySelector(`.tab-button[data-tab="${e}"]`);o&&o.click(),document.body.insertAdjacentHTML("beforeend",'\n        <div id="author-works-modal" class="modal">\n            <div class="modal-content">\n                <span class="close-button">&times;</span>\n                <h3 id="modal-author-name"></h3>\n                <p id="modal-author-institution" class="modal-subtitle"></p>\n                <div id="modal-works-list"></div>\n            </div>\n        </div>\n    ');const c=document.getElementById("author-works-modal"),d=document.querySelector("#author-works-modal .close-button");d&&d.addEventListener("click",()=>{c&&(c.style.display="none")}),window.addEventListener("click",t=>{t.target===c&&c&&(c.style.display="none")})})}},156:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,s){function a(t){try{c(o.next(t))}catch(t){s(t)}}function i(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,i)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const r=n(60),s=n(300);document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("root");t?((0,r.renderLandingPage)(t),document.addEventListener("click",t=>o(void 0,void 0,void 0,function*(){var e,n,o;const a=t.target;if(a.classList.contains("author-link")){t.preventDefault();const i=null===(e=a.dataset.authorId)||void 0===e?void 0:e.split("/").pop(),c=a.dataset.authorName;if(i&&c)try{const t=yield(0,s.fetchAuthorDetails)(i);console.log("Author details data:",t);const e=(null===(o=null===(n=t.author)||void 0===n?void 0:n.last_known_institutions)||void 0===o?void 0:o.map(t=>t.display_name).join(", "))||"N/A";console.log("Author institution:",e);const a=(yield(0,s.fetchAuthorWorks)(i)).works;let d="";a&&a.length>0?(d="<ul>",a.forEach(t=>{d+=`\n                                <li>\n                                    <h5>${t.title||"No Title"}</h5>\n                                    <p><strong>Authors:</strong> ${t.authorships.map(t=>t.author.display_name).join(", ")||"N/A"}</p>\n                                    <p><strong>Affiliations:</strong> ${t.authorships.flatMap(t=>t.institutions.map(t=>t.display_name)).filter(t=>t).join(", ")||"N/A"}</p>\n                                    <p><strong>FWCI:</strong> ${t.fwci||"N/A"}</p>\n                                </li>\n                            `}),d+="</ul>"):d="<p>No other works found for this author.</p>",(0,r.showAuthorWorksModal)(c,e,d)}catch(t){console.error("Error fetching author works or details:",t),alert("Failed to fetch author works or details. Please try again.")}}}))):console.error("Root element not found!")})},185:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.cleanUniversityName=function(t){return t.replace(/\s*\([^)]*\)/g,"").trim()},e.renderCards=function(t,e,n,o,r){if(t.innerHTML="",e&&e.length>0){const s=document.createElement("div");s.classList.add(r),e.forEach(t=>{const e=document.createElement("div");e.classList.add(...o),e.innerHTML=n(t),s.appendChild(e)}),t.appendChild(s)}else t.innerHTML="<p>No results found.</p>"}},300:function(t,e){var n=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,s){function a(t){try{c(o.next(t))}catch(t){s(t)}}function i(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,i)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.fetchFields=function(){return n(this,void 0,void 0,function*(){const t=yield fetch("/api/v1/fields");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})},e.searchPapers=function(t,e,o,r,s,a){return n(this,void 0,void 0,function*(){const n=new URLSearchParams({search_term:t,from_year:e.toString(),country_code:o,page:s.toString(),per_page:a.toString()});r.forEach(t=>n.append("topic_ids",t));const i=yield fetch(`/api/v1/search?${n.toString()}`);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()})},e.scrapePcsasData=function(){return n(this,void 0,void 0,function*(){const t=yield fetch("/api/v1/pcsas");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})},e.fetchAuthorWorks=function(t){return n(this,void 0,void 0,function*(){const e=yield fetch(`/api/v1/author_works/${t}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})},e.fetchAuthorDetails=function(t){return n(this,void 0,void 0,function*(){const e=yield fetch(`/api/v1/author_details/${t}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})},e.fetchCrossSearchUniversities=function(t,e){return n(this,void 0,void 0,function*(){const n=new URLSearchParams({search_term:t,top_x_works:e.toString()}),o=yield fetch(`/api/v1/cross_search_universities?${n.toString()}`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.json()})}},806:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,s){function a(t){try{c(o.next(t))}catch(t){s(t)}}function i(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,i)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.renderSearchTab=function(){const t=document.getElementById("tab-content-search");if(!t)return;t.innerHTML='\n        <h2>Search Academic Papers</h2>\n        <div class="search-elements-group">\n            <form id="search-form">\n                <input type="text" id="search-term" name="search_term" placeholder="Search Term" required><br><br>\n\n                <div class="input-group">\n                    <input type="number" id="from-year" name="from_year" value="1980" placeholder="From Year (default 1980)">\n                    <input type="text" id="country-code" name="country_code" value="US" placeholder="Country Code (default US)">\n                </div><br><br>\n\n                <h3>Select Topic IDs:</h3>\n                <div id="topic-ids-grid"></div>\n                <br>\n\n                <button type="submit">Search</button>\n            </form>\n        </div>\n        <div class="search-results-padding"></div> \x3c!-- Padding div --\x3e\n        <div id="search-results">\n            <div id="top-pagination-controls" class="pagination-controls"></div>\n            <div id="results-container"></div>\n            <div id="bottom-pagination-controls" class="pagination-controls"></div>\n        </div>\n    ';const e=document.getElementById("topic-ids-grid"),n=document.getElementById("search-form"),s=document.getElementById("search-results"),h=document.getElementById("top-pagination-controls"),p=document.getElementById("bottom-pagination-controls");document.getElementById("results-container");let f=[];const g=t=>{const e=document.createElement("button");e.textContent="Previous",e.id=`prev-button-${t.id}`,e.type="button",e.addEventListener("click",()=>{console.log(`Previous button clicked. Current page: ${a}`),m(a-1,s)}),t.appendChild(e);const n=document.createElement("button");n.textContent="Next",n.id=`next-button-${t.id}`,n.type="button",n.addEventListener("click",()=>{console.log(`Next button clicked. Current page: ${a}`),m(a+1,s)}),t.appendChild(n)};h&&(g(h),console.log("Top pagination controls setup.",h)),p&&(g(p),console.log("Bottom pagination controls setup.",p)),(()=>{o(this,void 0,void 0,function*(){try{const t=(yield(0,r.fetchFields)()).fields;if(e)for(const n in t){const o=document.createElement("div");o.classList.add("topic-button"),o.dataset.topicId=n,o.textContent=t[n],o.addEventListener("click",()=>{o.classList.toggle("selected"),o.classList.contains("selected")?f.push(n):f=f.filter(t=>t!==n)}),e.appendChild(o)}}catch(e){console.error("Error fetching fields:",e),t&&(t.innerHTML+="<p>Failed to load fields. Please check the backend server.</p>")}})})(),n&&n.addEventListener("submit",t=>o(this,void 0,void 0,function*(){t.preventDefault();const e=new FormData(n);i=e.get("search_term"),c=e.get("from_year")?parseInt(e.get("from_year")):1980,d=e.get("country_code")||"US",l=f,a=0;for(const t in u)delete u[t];if(s){const t=s.querySelector("#results-container");if(t&&(t.innerHTML=""),document.querySelectorAll('[id^="prev-button-"]').forEach(t=>t.disabled=!0),document.querySelectorAll('[id^="next-button-"]').forEach(t=>t.disabled=!0),document.querySelectorAll(".pagination-controls").forEach(t=>t.style.display="none"),s){const t=s.querySelector("#results-container");t&&(t.innerHTML=""),yield m(1,s)}}}))};const r=n(300),s=n(185);let a=0,i="",c=1980,d="US",l=[];const u={};let h=!1;const p=25;function m(t,e){return o(this,void 0,void 0,function*(){if(console.log(`fetchAndRenderPage called for page: ${t}`),h)return void console.log("Already loading, returning.");h=!0,a=t;const n=e.querySelector("#results-container");if(!n)return console.error("Results container not found!"),void(h=!1);n.innerHTML="<p>Loading results...</p>";const m=document.querySelectorAll(".pagination-controls");console.log("Hiding pagination controls."),m.forEach(t=>t.style.display="none");try{let e=[],h=!1;u[t]?(console.log(`Page ${t} found in cache.`),e=u[t],delete u[t]):(console.log(`Fetching page ${t} from API.`),e=(yield(0,r.searchPapers)(i,c,d,l,t,p)).works),console.log(`Fetched ${e.length} works for page ${t}.`),h=e.length===p,console.log(`Has next page: ${h}`),function(t,e){console.log(`renderWorks called with ${t.length} works.`),(0,s.renderCards)(e,t,t=>`\n            <h4>${t.doi?`<a href="https://doi.org/${t.doi}" target="_blank">${t.title||"No Title"}</a>`:t.title||"No Title"}</h4>\n            <p><strong>Authors:</strong> ${t.authorships.map(t=>`<span class="author-link" data-author-id="${t.author.id}" data-author-name="${t.author.display_name}">${t.author.display_name}</span>`).join(", ")||"N/A"}</p>\n            <p><strong>Affiliations:</strong> ${Array.from(new Set(t.authorships.flatMap(t=>t.institutions.map(t=>t.homepage_url?`<a href="${t.homepage_url}" target="_blank">${t.display_name}</a>`:t.display_name)).filter(t=>t))).join(", ")||"N/A"}</p>\n            <p><strong>FWCI:</strong> ${t.fwci||"N/A"}</p>\n            <p><strong>Publication Date:</strong> ${t.publication_date||"N/A"}</p>\n        `,["work-card","card-element"],"works-grid")}(e,n);const f=document.querySelectorAll('[id^="prev-button-"]'),g=document.querySelectorAll('[id^="next-button-"]');console.log("Updating button disabled states."),f.forEach(t=>t.disabled=1===a),g.forEach(t=>t.disabled=!h),e.length>0?(console.log("Showing pagination controls."),m.forEach(t=>t.style.display="flex")):console.log("No works found, keeping pagination controls hidden."),function(){o(this,void 0,void 0,function*(){console.log("Starting preloadPages. Current page:",a);for(let t=1;t<=4;t++){const e=a+t;if(console.log(`Attempting to preload page ${e}.`),!u[e]&&e<=400)try{console.log(`Fetching preload page ${e} from API.`);const t=yield(0,r.searchPapers)(i,c,d,l,e,p);if(!(t.works&&t.works.length>0)){console.log(`Preload page ${e} returned no works. Stopping preloading.`);break}u[e]=t.works,console.log(`Preloaded page ${e} with ${t.works.length} works.`)}catch(t){console.warn(`Failed to preload page ${e}:`,t);break}else u[e]?console.log(`Page ${e} already in cache, skipping preload.`):console.log(`Page ${e} is beyond preload limit (400 pages), skipping preload.`)}})}()}catch(t){console.error("Error during search:",t),n.innerHTML=`<p>Error performing search: ${t.message}. Please try again.</p>`}finally{h=!1,console.log("Loading finished.")}})}},807:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,s){function a(t){try{c(o.next(t))}catch(t){s(t)}}function i(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,i)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.renderCrossSearchTab=function(){const t=document.getElementById("tab-content-cross-search");if(!t)return void console.error("Cross-Search tab content div not found!");t.innerHTML='\n        <h2>Cross-Search Universities</h2>\n        <div class="search-elements-group">\n            <form id="cross-search-form">\n                <input type="text" id="cross-search-term" name="search_term" placeholder="Enter search term (e.g., psychology)" required>\n\n                <div class="input-group">\n                    <input type="number" id="top-x-works" name="top_x_works" value="10" min="1" max="100" placeholder="Top Works (default 10)">\n                </div>\n\n                <button type="submit">Search Common Universities</button>\n            </form>\n        </div>\n        <div id="cross-search-results" class="results-container hidden">\n                <div id="cross-search-results-grid">\n                </div>\n            </div>\n    ';const e=document.getElementById("cross-search-form"),n=document.getElementById("cross-search-results"),a=document.getElementById("cross-search-results-grid");null==e||e.addEventListener("submit",t=>o(this,void 0,void 0,function*(){t.preventDefault();const o=new FormData(e),i=o.get("search_term"),c=parseInt(o.get("top_x_works"),10);if(i){a.innerHTML="<p>Loading...</p>",n.classList.remove("hidden");try{const t=yield(0,r.fetchCrossSearchUniversities)(i,c);if(t.common_universities&&t.common_universities.length>0){const e=document.createElement("h3");e.textContent="Institutions",n.prepend(e),(0,s.renderCards)(a,t.common_universities,t=>`\n                        <a href="${t.website}" target="_blank">${(0,s.cleanUniversityName)(t.name)}</a>\n                    `,["university-card","card-element"],"university-grid")}else a.innerHTML="<p>No common universities found.</p>"}catch(t){console.error("Error during cross-search:",t),a.innerHTML="<p>Error fetching common universities.</p>"}}else alert("Please enter a search term.")}))};const r=n(300),s=n(185)},966:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,s){function a(t){try{c(o.next(t))}catch(t){s(t)}}function i(t){try{c(o.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,i)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.renderPcsasTab=function(){const t=document.getElementById("tab-content-pcsas");if(!t)return;t.innerHTML='\n        <h2>PCSAS</h2>\n        <div class="search-elements-group">\n            <button id="scrape-pcsas-button">Scrape PCSAS Data</button>\n        </div>\n        <div id="pcsas-results" class="results-container hidden">\n                <div id="pcsas-programs-grid-container">\n                </div>\n            </div>\n    ';const e=document.getElementById("scrape-pcsas-button"),n=document.getElementById("pcsas-results"),a=document.getElementById("pcsas-programs-grid-container");console.log("pcsasResultsDiv:",n),console.log("pcsasProgramsGridContainer:",a),e&&n&&a&&e.addEventListener("click",()=>o(this,void 0,void 0,function*(){a.innerHTML="<p>Scraping PCSAS data... This may take a moment.</p>",n.classList.remove("hidden"),console.log("pcsasResultsDiv hidden class removed.");try{const t=(yield(0,r.scrapePcsasData)()).programs;if(t&&t.length>0){const e=document.createElement("h3");e.textContent="PCSAS Programs",n.prepend(e),(0,s.renderCards)(a,t,t=>`\n                            <h4><a href="${t.website}" target="_blank">${(0,s.cleanUniversityName)(t.program_name||"No Name")}</a></h4>\n                            ${t.student_outcomes_link&&t.student_outcomes_link!==t.website?`<p class="small-text"><a href="${t.student_outcomes_link}" target="_blank">Student Outcomes</a></p>`:""}\n                        `,["university-card","card-element"],"university-grid")}else a.innerHTML="<p>No PCSAS programs found.</p>"}catch(t){console.error("Error scraping PCSAS data:",t),a.innerHTML=`<p>Error scraping PCSAS data: ${t.message}. Please try again.</p>`}}))};const r=n(300),s=n(185)}},e={};!function n(o){var r=e[o];if(void 0!==r)return r.exports;var s=e[o]={exports:{}};return t[o].call(s.exports,s,s.exports,n),s.exports}(156)})();
