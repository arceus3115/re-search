(()=>{"use strict";var t={60:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,a){function i(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,s)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.renderLandingPage=i,e.renderApp=s,e.showAuthorWorksModal=function(t,e,n){const o=document.getElementById("author-works-modal"),r=document.getElementById("modal-author-name"),a=document.getElementById("modal-author-institution"),i=document.getElementById("modal-works-list");o&&r&&a&&i&&(r.textContent=`Works by ${t}`,a.textContent=e,i.innerHTML=n,o.style.display="flex")};const r=n(806),a=n(966);function i(t){t.innerHTML='\n        <div class="landing-page">\n            <h1>Research Network Hub</h1>\n            <p>Welcome to your central hub for academic research tools.</p>\n            <h2>Available Tools</h2>\n            <div class="tool-list">\n                <button class="tool-button" data-tool="search">Academic Paper Search</button>\n                <button class="tool-button" data-tool="pcsas">PCSAS</button>\n            </div>\n            <h2>Your Network Dashboard</h2>\n            <div id="network-animation-placeholder" style="height: 300px; background-color: #f0f0f0; display: flex; justify-content: center; align-items: center; border-radius: 8px;">\n                <p>Cool Network Animation Placeholder</p>\n            </div>\n        </div>\n    ',document.querySelectorAll(".tool-button").forEach(e=>{e.addEventListener("click",e=>{const n=e.target.dataset.tool;n&&s(t,n)})})}function s(t){return o(this,arguments,void 0,function*(t,e="search"){t.innerHTML='\n        <div class="app-header">\n            <div class="logo">Research Network</div>\n            <div class="tabs">\n                <button class="tab-button" data-tab="search">Academic Paper Search</button>\n                <button class="tab-button" data-tab="pcsas">PCSAS</button>\n            </div>\n        </div>\n        <div class="app-container">\n            <div id="tab-content-search" class="tab-content"></div>\n            <div id="tab-content-pcsas" class="tab-content"></div>\n        </div>\n    ';const n=document.querySelector(".app-header .logo");n&&(n.style.cursor="pointer",n.addEventListener("click",()=>{i(t)})),(0,r.renderSearchTab)(),(0,a.renderPcsasTab)(),document.querySelectorAll(".tab-button").forEach(t=>{t.addEventListener("click",t=>{const e=t.target.dataset.tab;if(document.querySelectorAll(".tab-content").forEach(t=>{t.style.display="none"}),document.querySelectorAll(".tab-button").forEach(t=>{t.classList.remove("active")}),e){const n=document.getElementById(`tab-content-${e}`);n&&(n.style.display="block"),t.target.classList.add("active")}})});const o=document.querySelector(`.tab-button[data-tab="${e}"]`);o&&o.click(),document.body.insertAdjacentHTML("beforeend",'\n        <div id="author-works-modal" class="modal">\n            <div class="modal-content">\n                <span class="close-button">&times;</span>\n                <h3 id="modal-author-name"></h3>\n                <p id="modal-author-institution" class="modal-subtitle"></p>\n                <div id="modal-works-list"></div>\n            </div>\n        </div>\n    ');const s=document.getElementById("author-works-modal"),c=document.querySelector("#author-works-modal .close-button");c&&c.addEventListener("click",()=>{s&&(s.style.display="none")}),window.addEventListener("click",t=>{t.target===s&&s&&(s.style.display="none")})})}},156:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,a){function i(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,s)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const r=n(60),a=n(300);document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("root");t?((0,r.renderLandingPage)(t),document.addEventListener("click",t=>o(void 0,void 0,void 0,function*(){var e,n,o;const i=t.target;if(i.classList.contains("author-link")){t.preventDefault();const s=null===(e=i.dataset.authorId)||void 0===e?void 0:e.split("/").pop(),c=i.dataset.authorName;if(s&&c)try{const t=yield(0,a.fetchAuthorDetails)(s);console.log("Author details data:",t);const e=(null===(o=null===(n=t.author)||void 0===n?void 0:n.last_known_institutions)||void 0===o?void 0:o.map(t=>t.display_name).join(", "))||"N/A";console.log("Author institution:",e);const i=(yield(0,a.fetchAuthorWorks)(s)).works;let l="";i&&i.length>0?(l="<ul>",i.forEach(t=>{l+=`\n                                <li>\n                                    <h5>${t.title||"No Title"}</h5>\n                                    <p><strong>Authors:</strong> ${t.authorships.map(t=>t.author.display_name).join(", ")||"N/A"}</p>\n                                    <p><strong>Affiliations:</strong> ${t.authorships.flatMap(t=>t.institutions.map(t=>t.display_name)).filter(t=>t).join(", ")||"N/A"}</p>\n                                    <p><strong>FWCI:</strong> ${t.fwci||"N/A"}</p>\n                                </li>\n                            `}),l+="</ul>"):l="<p>No other works found for this author.</p>",(0,r.showAuthorWorksModal)(c,e,l)}catch(t){console.error("Error fetching author works or details:",t),alert("Failed to fetch author works or details. Please try again.")}}}))):console.error("Root element not found!")})},300:function(t,e){var n=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,a){function i(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,s)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.fetchFields=function(){return n(this,void 0,void 0,function*(){const t=yield fetch("/api/v1/fields");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})},e.searchPapers=function(t,e,o,r,a,i){return n(this,void 0,void 0,function*(){const n=new URLSearchParams({search_term:t,from_year:e.toString(),country_code:o,page:a.toString(),per_page:i.toString()});r.forEach(t=>n.append("topic_ids",t));const s=yield fetch(`/api/v1/search?${n.toString()}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()})},e.scrapePcsasData=function(){return n(this,void 0,void 0,function*(){const t=yield fetch("/api/v1/pcsas");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})},e.fetchAuthorWorks=function(t){return n(this,void 0,void 0,function*(){const e=yield fetch(`/api/v1/author_works/${t}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})},e.fetchAuthorDetails=function(t){return n(this,void 0,void 0,function*(){const e=yield fetch(`/api/v1/author_details/${t}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})}},806:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,a){function i(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,s)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.renderSearchTab=function(){const t=document.getElementById("tab-content-search");if(!t)return;t.innerHTML='\n        <h2>Search Academic Papers</h2>\n        <form id="search-form">\n            <input type="text" id="search-term" name="search_term" placeholder="Search Term" required><br><br>\n\n            <input type="number" id="from-year" name="from_year" value="1980" placeholder="From Year (default 1980)"><br><br>\n\n            <input type="text" id="country-code" name="country_code" value="US" placeholder="Country Code (default US)"><br><br>\n\n            <h3>Select Topic IDs:</h3>\n            <div id="topic-ids-grid"></div>\n            <br>\n\n            <button type="submit">Search</button>\n        </form>\n        <div class="search-results-padding"></div> \x3c!-- Padding div --\x3e\n        <div id="search-results">\n            <div id="top-pagination-controls" class="pagination-controls"></div>\n            <div id="results-container"></div>\n            <div id="bottom-pagination-controls" class="pagination-controls"></div>\n        </div>\n    ';const e=document.getElementById("topic-ids-grid"),n=document.getElementById("search-form"),u=document.getElementById("search-results"),p=document.getElementById("top-pagination-controls"),f=document.getElementById("bottom-pagination-controls");document.getElementById("results-container");let g=[];const m=t=>{const e=document.createElement("button");e.textContent="Previous",e.id=`prev-button-${t.id}`,e.type="button",e.addEventListener("click",()=>{console.log(`Previous button clicked. Current page: ${a}`),h(a-1,u)}),t.appendChild(e);const n=document.createElement("button");n.textContent="Next",n.id=`next-button-${t.id}`,n.type="button",n.addEventListener("click",()=>{console.log(`Next button clicked. Current page: ${a}`),h(a+1,u)}),t.appendChild(n)};p&&(m(p),console.log("Top pagination controls setup.",p)),f&&(m(f),console.log("Bottom pagination controls setup.",f)),(()=>{o(this,void 0,void 0,function*(){try{const t=(yield(0,r.fetchFields)()).fields;if(e)for(const n in t){const o=document.createElement("div");o.classList.add("topic-button"),o.dataset.topicId=n,o.textContent=t[n],o.addEventListener("click",()=>{o.classList.toggle("selected"),o.classList.contains("selected")?g.push(n):g=g.filter(t=>t!==n)}),e.appendChild(o)}}catch(e){console.error("Error fetching fields:",e),t&&(t.innerHTML+="<p>Failed to load fields. Please check the backend server.</p>")}})})(),n&&n.addEventListener("submit",t=>o(this,void 0,void 0,function*(){t.preventDefault();const e=new FormData(n);i=e.get("search_term"),s=e.get("from_year")?parseInt(e.get("from_year")):1980,c=e.get("country_code")||"US",l=g,a=0;for(const t in d)delete d[t];if(u){const t=u.querySelector("#results-container");if(t&&(t.innerHTML=""),document.querySelectorAll('[id^="prev-button-"]').forEach(t=>t.disabled=!0),document.querySelectorAll('[id^="next-button-"]').forEach(t=>t.disabled=!0),document.querySelectorAll(".pagination-controls").forEach(t=>t.style.display="none"),u){const t=u.querySelector("#results-container");t&&(t.innerHTML=""),yield h(1,u)}}}))};const r=n(300);let a=0,i="",s=1980,c="US",l=[];const d={};let u=!1;const p=25;function h(t,e){return o(this,void 0,void 0,function*(){if(console.log(`fetchAndRenderPage called for page: ${t}`),u)return void console.log("Already loading, returning.");u=!0,a=t;const n=e.querySelector("#results-container");if(!n)return console.error("Results container not found!"),void(u=!1);n.innerHTML="<p>Loading results...</p>";const h=document.querySelectorAll(".pagination-controls");console.log("Hiding pagination controls."),h.forEach(t=>t.style.display="none");try{let e=[],u=!1;d[t]?(console.log(`Page ${t} found in cache.`),e=d[t],delete d[t]):(console.log(`Fetching page ${t} from API.`),e=(yield(0,r.searchPapers)(i,s,c,l,t,p)).works),console.log(`Fetched ${e.length} works for page ${t}.`),u=e.length===p,console.log(`Has next page: ${u}`),function(t,e){if(console.log(`renderWorks called with ${t.length} works.`),e.innerHTML="",t&&t.length>0){const n=document.createElement("ul");console.log("Created ul element:",n),t.forEach(t=>{const e=document.createElement("li");e.innerHTML=`\n                <h4>${t.doi?`<a href="https://doi.org/${t.doi}" target="_blank">${t.title||"No Title"}</a>`:t.title||"No Title"}</h4>\n                <p><strong>Authors:</strong> ${t.authorships.map(t=>`<span class="author-link" data-author-id="${t.author.id}" data-author-name="${t.author.display_name}">${t.author.display_name}</span>`).join(", ")||"N/A"}</p>\n                <p><strong>Affiliations:</strong> ${Array.from(new Set(t.authorships.flatMap(t=>t.institutions.map(t=>(console.log("Institution:",t.display_name,"Homepage URL:",t.homepage_url),t.homepage_url?`<a href="${t.homepage_url}" target="_blank">${t.display_name}</a>`:t.display_name))).filter(t=>t))).join(", ")||"N/A"}</p>\n                <p><strong>FWCI:</strong> ${t.fwci||"N/A"}</p>\n                \n                <p><strong>Publication Date:</strong> ${t.publication_date||"N/A"}</p>\n            `,n.appendChild(e)}),e.appendChild(n)}else e.innerHTML="<p>No results found for your search.</p>"}(e,n);const f=document.querySelectorAll('[id^="prev-button-"]'),g=document.querySelectorAll('[id^="next-button-"]');console.log("Updating button disabled states."),f.forEach(t=>t.disabled=1===a),g.forEach(t=>t.disabled=!u),e.length>0?(console.log("Showing pagination controls."),h.forEach(t=>t.style.display="flex")):console.log("No works found, keeping pagination controls hidden."),function(){o(this,void 0,void 0,function*(){console.log("Starting preloadPages. Current page:",a);for(let t=1;t<=4;t++){const e=a+t;if(console.log(`Attempting to preload page ${e}.`),!d[e]&&e<=400)try{console.log(`Fetching preload page ${e} from API.`);const t=yield(0,r.searchPapers)(i,s,c,l,e,p);if(!(t.works&&t.works.length>0)){console.log(`Preload page ${e} returned no works. Stopping preloading.`);break}d[e]=t.works,console.log(`Preloaded page ${e} with ${t.works.length} works.`)}catch(t){console.warn(`Failed to preload page ${e}:`,t);break}else d[e]?console.log(`Page ${e} already in cache, skipping preload.`):console.log(`Page ${e} is beyond preload limit (400 pages), skipping preload.`)}})}()}catch(t){console.error("Error during search:",t),n.innerHTML=`<p>Error performing search: ${t.message}. Please try again.</p>`}finally{u=!1,console.log("Loading finished.")}})}},966:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,a){function i(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,s)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.renderPcsasTab=function(){const t=document.getElementById("tab-content-pcsas");if(!t)return;t.innerHTML='\n        <h2>PCSAS</h2>\n        <button id="scrape-pcsas-button">Scrape PCSAS Data</button>\n        <div id="pcsas-results"></div>\n    ';const e=document.getElementById("scrape-pcsas-button"),n=document.getElementById("pcsas-results");e&&e.addEventListener("click",()=>o(this,void 0,void 0,function*(){n&&(n.innerHTML="<p>Scraping PCSAS data... This may take a moment.</p>");try{const t=(yield(0,r.scrapePcsasData)()).programs;if(n)if(n.innerHTML="<h3>PCSAS Programs:</h3>",t&&t.length>0){const e=document.createElement("ul");t.forEach(t=>{const n=document.createElement("li");n.innerHTML=`\n                                <h4><a href="${t.website}" target="_blank">${t.program_name||"No Name"}</a></h4>\n                                ${t.student_outcomes_link&&t.student_outcomes_link!==t.website?`<p><a href="${t.student_outcomes_link}" target="_blank">View Student Outcomes</a></p>`:""}\n                            `,e.appendChild(n)}),n.appendChild(e)}else n.innerHTML+="<p>No PCSAS programs found.</p>"}catch(t){console.error("Error scraping PCSAS data:",t),n&&(n.innerHTML=`<p>Error scraping PCSAS data: ${t.message}. Please try again.</p>`)}}))};const r=n(300)}},e={};!function n(o){var r=e[o];if(void 0!==r)return r.exports;var a=e[o]={exports:{}};return t[o].call(a.exports,a,a.exports,n),a.exports}(156)})();