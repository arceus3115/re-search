(()=>{"use strict";var e={60:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,i)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.renderLandingPage=i,t.renderApp=c,t.showAuthorWorksModal=function(e,t,n){const o=document.getElementById("author-works-modal"),r=document.getElementById("modal-author-name"),s=document.getElementById("modal-author-institution"),a=document.getElementById("modal-works-list");o&&r&&s&&a&&(r.textContent=`Works by ${e}`,s.textContent=t,a.innerHTML=n,o.style.display="flex")};const r=n(806),s=n(966),a=n(807);function i(e){e.innerHTML='\n        <div class="landing-page">\n            <h1>Research Network Hub</h1>\n            <p>Welcome to your central hub for academic research tools.</p>\n            <h2>Available Tools</h2>\n            <div class="tool-list">\n                <button class="tool-button" data-tool="search">Academic Paper Search</button>\n                <button class="tool-button" data-tool="pcsas">PCSAS</button>\n                <button class="tool-button" data-tool="cross-search">Cross-Search Universities</button>\n            </div>\n            <h2>Your Network Dashboard</h2>\n            <div id="network-animation-placeholder" style="height: 300px; background-color: #f0f0f0; display: flex; justify-content: center; align-items: center; border-radius: 8px;">\n                <p>Cool Network Animation Placeholder</p>\n            </div>\n        </div>\n    ',document.querySelectorAll(".tool-button").forEach(t=>{t.addEventListener("click",t=>{const n=t.target.dataset.tool;n&&c(e,n)})})}function c(e){return o(this,arguments,void 0,function*(e,t="search"){e.innerHTML='\n        <div class="app-header">\n            <div class="logo">Research Network</div>\n            <div class="tabs">\n                <button class="tab-button" data-tab="search">Academic Paper Search</button>\n                <button class="tab-button" data-tab="pcsas">PCSAS</button>\n                <button class="tab-button" data-tab="cross-search">Cross-Search Universities</button>\n            </div>\n        </div>\n        <div class="app-container">\n            <div id="tab-content-search" class="tab-content"></div>\n            <div id="tab-content-pcsas" class="tab-content"></div>\n            <div id="tab-content-cross-search" class="tab-content"></div>\n        </div>\n    ';const n=document.querySelector(".app-header .logo");n&&(n.style.cursor="pointer",n.addEventListener("click",()=>{i(e)})),(0,r.renderSearchTab)(),(0,s.renderPcsasTab)(),(0,a.renderCrossSearchTab)(),document.querySelectorAll(".tab-button").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.dataset.tab;if(document.querySelectorAll(".tab-content").forEach(e=>{e.style.display="none"}),document.querySelectorAll(".tab-button").forEach(e=>{e.classList.remove("active")}),t){const n=document.getElementById(`tab-content-${t}`);n&&(n.style.display="block"),e.target.classList.add("active")}})});const o=document.querySelector(`.tab-button[data-tab="${t}"]`);o&&o.click(),document.body.insertAdjacentHTML("beforeend",'\n        <div id="author-works-modal" class="modal">\n            <div class="modal-content">\n                <span class="close-button">&times;</span>\n                <h3 id="modal-author-name"></h3>\n                <p id="modal-author-institution" class="modal-subtitle"></p>\n                <div id="modal-works-list"></div>\n            </div>\n        </div>\n    ');const c=document.getElementById("author-works-modal"),d=document.querySelector("#author-works-modal .close-button");d&&d.addEventListener("click",()=>{c&&(c.style.display="none")}),window.addEventListener("click",e=>{e.target===c&&c&&(c.style.display="none")})})}},156:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,i)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(60),s=n(300);document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("root");e?((0,r.renderLandingPage)(e),document.addEventListener("click",e=>o(void 0,void 0,void 0,function*(){var t,n,o;const a=e.target;if(a.classList.contains("author-link")){e.preventDefault();const i=null===(t=a.dataset.authorId)||void 0===t?void 0:t.split("/").pop(),c=a.dataset.authorName;if(i&&c)try{const e=yield(0,s.fetchAuthorDetails)(i);console.log("Author details data:",e);const t=(null===(o=null===(n=e.author)||void 0===n?void 0:n.last_known_institutions)||void 0===o?void 0:o.map(e=>e.display_name).join(", "))||"N/A";console.log("Author institution:",t);const a=(yield(0,s.fetchAuthorWorks)(i)).works;let d="";a&&a.length>0?(d="<ul>",a.forEach(e=>{d+=`\n                                <li>\n                                    <h5>${e.title||"No Title"}</h5>\n                                    <p><strong>Authors:</strong> ${e.authorships.map(e=>e.author.display_name).join(", ")||"N/A"}</p>\n                                    <p><strong>Affiliations:</strong> ${e.authorships.flatMap(e=>e.institutions.map(e=>e.display_name)).filter(e=>e).join(", ")||"N/A"}</p>\n                                    <p><strong>FWCI:</strong> ${e.fwci||"N/A"}</p>\n                                </li>\n                            `}),d+="</ul>"):d="<p>No other works found for this author.</p>",(0,r.showAuthorWorksModal)(c,t,d)}catch(e){console.error("Error fetching author works or details:",e),alert("Failed to fetch author works or details. Please try again.")}}}))):console.error("Root element not found!")})},185:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cleanUniversityName=function(e){return e.replace(/\s*\([^)]*\)/g,"").trim()},t.renderCards=function(e,t,n,o,r){if(e.innerHTML="",t&&t.length>0){const s=document.createElement("div");s.classList.add(r),t.forEach(e=>{const t=document.createElement("div");t.classList.add(...o),t.innerHTML=n(e),s.appendChild(t)}),e.appendChild(s)}else e.innerHTML="<p>No results found.</p>"}},300:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,i)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchFields=function(){return n(this,void 0,void 0,function*(){const e=yield fetch("/api/v1/fields");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})},t.searchPapers=function(e,t,o,r,s,a){return n(this,void 0,void 0,function*(){const n=new URLSearchParams({search_term:e,from_year:t.toString(),country_code:o,page:s.toString(),per_page:a.toString()});r.forEach(e=>n.append("topic_ids",e));const i=yield fetch(`/api/v1/search?${n.toString()}`);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()})},t.scrapePcsasData=function(){return n(this,void 0,void 0,function*(){const e=yield fetch("/api/v1/pcsas");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})},t.fetchAuthorWorks=function(e){return n(this,void 0,void 0,function*(){const t=yield fetch(`/api/v1/author_works/${e}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})},t.fetchAuthorDetails=function(e){return n(this,void 0,void 0,function*(){const t=yield fetch(`/api/v1/author_details/${e}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})},t.fetchCrossSearchUniversities=function(e,t){return n(this,void 0,void 0,function*(){const n=new URLSearchParams({search_term:e,top_x_works:t.toString()}),o=yield fetch(`/api/v1/cross_search_universities?${n.toString()}`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.json()})}},806:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,i)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.renderSearchTab=function(){const e=document.getElementById("tab-content-search");if(!e)return;e.innerHTML='\n        <h2>Search Academic Papers</h2>\n        <div class="search-elements-group">\n            <form id="search-form">\n                <input type="text" id="search-term" name="search_term" placeholder="Search Term" required>\n\n                <div class="input-group">\n                    <input type="number" id="from-year" name="from_year" value="1980" placeholder="From Year (default 1980)">\n                    <input type="text" id="country-code" name="country_code" value="US" placeholder="Country Code (default US)">\n                </div>\n\n                <h3>Select Topic IDs:</h3>\n                <div id="topic-ids-grid"></div>\n\n                <button type="submit">Search</button>\n            </form>\n        </div>\n        <div class="search-results-padding"></div> \x3c!-- Padding div --\x3e\n        <div id="search-results">\n            <div id="top-pagination-controls" class="pagination-controls"></div>\n            <div id="results-container"></div>\n            <div id="bottom-pagination-controls" class="pagination-controls"></div>\n        </div>\n    ';const t=document.getElementById("topic-ids-grid"),n=document.getElementById("search-form"),s=document.getElementById("search-results"),h=document.getElementById("top-pagination-controls"),p=document.getElementById("bottom-pagination-controls");document.getElementById("results-container");let f=[];const g=e=>{const t=document.createElement("button");t.textContent="Previous",t.id=`prev-button-${e.id}`,t.type="button",t.addEventListener("click",()=>{console.log(`Previous button clicked. Current page: ${a}`),m(a-1,s)}),e.appendChild(t);const n=document.createElement("button");n.textContent="Next",n.id=`next-button-${e.id}`,n.type="button",n.addEventListener("click",()=>{console.log(`Next button clicked. Current page: ${a}`),m(a+1,s)}),e.appendChild(n)};h&&(g(h),console.log("Top pagination controls setup.",h)),p&&(g(p),console.log("Bottom pagination controls setup.",p)),(()=>{o(this,void 0,void 0,function*(){try{const e=(yield(0,r.fetchFields)()).fields;if(t)for(const n in e){const o=document.createElement("div");o.classList.add("topic-button"),o.dataset.topicId=n,o.textContent=e[n],o.addEventListener("click",()=>{o.classList.toggle("selected"),o.classList.contains("selected")?f.push(n):f=f.filter(e=>e!==n)}),t.appendChild(o)}}catch(t){console.error("Error fetching fields:",t),e&&(e.innerHTML+="<p>Failed to load fields. Please check the backend server.</p>")}})})(),n&&n.addEventListener("submit",e=>o(this,void 0,void 0,function*(){e.preventDefault();const t=new FormData(n);i=t.get("search_term"),c=t.get("from_year")?parseInt(t.get("from_year")):1980,d=t.get("country_code")||"US",l=f,a=0;for(const e in u)delete u[e];if(s){const e=s.querySelector("#results-container");if(e&&(e.innerHTML=""),document.querySelectorAll('[id^="prev-button-"]').forEach(e=>e.disabled=!0),document.querySelectorAll('[id^="next-button-"]').forEach(e=>e.disabled=!0),document.querySelectorAll(".pagination-controls").forEach(e=>e.style.display="none"),s){const e=s.querySelector("#results-container");e&&(e.innerHTML=""),yield m(1,s)}}}))};const r=n(300),s=n(185);let a=0,i="",c=1980,d="US",l=[];const u={};let h=!1;const p=25;function m(e,t){return o(this,void 0,void 0,function*(){if(console.log(`fetchAndRenderPage called for page: ${e}`),h)return void console.log("Already loading, returning.");h=!0,a=e;const n=t.querySelector("#results-container");if(!n)return console.error("Results container not found!"),void(h=!1);n.innerHTML="<p>Loading results...</p>";const m=document.querySelectorAll(".pagination-controls");console.log("Hiding pagination controls."),m.forEach(e=>e.style.display="none");try{let t=[],h=!1;u[e]?(console.log(`Page ${e} found in cache.`),t=u[e],delete u[e]):(console.log(`Fetching page ${e} from API.`),t=(yield(0,r.searchPapers)(i,c,d,l,e,p)).works),console.log(`Fetched ${t.length} works for page ${e}.`),h=t.length===p,console.log(`Has next page: ${h}`),function(e,t){console.log(`renderWorks called with ${e.length} works.`),(0,s.renderCards)(t,e,e=>`\n            <h4>${e.doi?`<a href="https://doi.org/${e.doi}" target="_blank">${e.title||"No Title"}</a>`:e.title||"No Title"}</h4>\n            <p><strong>Authors:</strong> ${e.authorships.map(e=>`<span class="author-link" data-author-id="${e.author.id}" data-author-name="${e.author.display_name}">${e.author.display_name}</span>`).join(", ")||"N/A"}</p>\n            <p><strong>Affiliations:</strong> ${Array.from(new Set(e.authorships.flatMap(e=>e.institutions.map(e=>e.homepage_url?`<a href="${e.homepage_url}" target="_blank">${e.display_name}</a>`:e.display_name)).filter(e=>e))).join(", ")||"N/A"}</p>\n            <p><strong>FWCI:</strong> ${e.fwci||"N/A"}</p>\n            <p><strong>Publication Date:</strong> ${e.publication_date||"N/A"}</p>\n        `,["work-card","card-element"],"works-grid")}(t,n);const f=document.querySelectorAll('[id^="prev-button-"]'),g=document.querySelectorAll('[id^="next-button-"]');console.log("Updating button disabled states."),f.forEach(e=>e.disabled=1===a),g.forEach(e=>e.disabled=!h),t.length>0?(console.log("Showing pagination controls."),m.forEach(e=>e.style.display="flex")):console.log("No works found, keeping pagination controls hidden."),function(){o(this,void 0,void 0,function*(){console.log("Starting preloadPages. Current page:",a);for(let e=1;e<=4;e++){const t=a+e;if(console.log(`Attempting to preload page ${t}.`),!u[t]&&t<=400)try{console.log(`Fetching preload page ${t} from API.`);const e=yield(0,r.searchPapers)(i,c,d,l,t,p);if(!(e.works&&e.works.length>0)){console.log(`Preload page ${t} returned no works. Stopping preloading.`);break}u[t]=e.works,console.log(`Preloaded page ${t} with ${e.works.length} works.`)}catch(e){console.warn(`Failed to preload page ${t}:`,e);break}else u[t]?console.log(`Page ${t} already in cache, skipping preload.`):console.log(`Page ${t} is beyond preload limit (400 pages), skipping preload.`)}})}()}catch(e){console.error("Error during search:",e),n.innerHTML=`<p>Error performing search: ${e.message}. Please try again.</p>`}finally{h=!1,console.log("Loading finished.")}})}},807:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,i)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.renderCrossSearchTab=function(){const e=document.getElementById("tab-content-cross-search");if(!e)return void console.error("Cross-Search tab content div not found!");e.innerHTML='\n        <h2>Cross-Search Universities</h2>\n        <div class="search-elements-group">\n            <form id="cross-search-form">\n                <input type="text" id="cross-search-term" name="search_term" placeholder="Enter search term (e.g., psychology)" required>\n\n                <div class="input-group">\n                    <input type="number" id="top-x-works" name="top_x_works" value="10" min="1" max="100" placeholder="Top Works (default 10)">\n                </div>\n\n                <button type="submit">Search Common Universities</button>\n            </form>\n        </div>\n        <div id="cross-search-results" class="results-container hidden">\n                <div id="cross-search-results-grid">\n                </div>\n            </div>\n    ';const t=document.getElementById("cross-search-form"),n=document.getElementById("cross-search-results"),a=document.getElementById("cross-search-results-grid");null==t||t.addEventListener("submit",e=>o(this,void 0,void 0,function*(){e.preventDefault();const o=new FormData(t),i=o.get("search_term"),c=parseInt(o.get("top_x_works"),10);if(i){a.innerHTML="<p>Loading...</p>",n.classList.remove("hidden");try{const e=yield(0,r.fetchCrossSearchUniversities)(i,c);if(e.common_universities&&e.common_universities.length>0){const t=document.createElement("h3");t.textContent="Common Universities:",n.prepend(t),(0,s.renderCards)(a,e.common_universities,e=>`\n                        <a href="${e.website}" target="_blank">${(0,s.cleanUniversityName)(e.name)}</a>\n                    `,["university-card","card-element"],"university-grid")}else a.innerHTML="<p>No common universities found.</p>"}catch(e){console.error("Error during cross-search:",e),a.innerHTML="<p>Error fetching common universities.</p>"}}else alert("Please enter a search term.")}))};const r=n(300),s=n(185)},966:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,i)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.renderPcsasTab=function(){const e=document.getElementById("tab-content-pcsas");if(!e)return;e.innerHTML='\n        <h2>PCSAS</h2>\n        <div class="search-elements-group">\n            <button id="scrape-pcsas-button">Scrape PCSAS Data</button>\n        </div>\n        <div id="pcsas-results" class="results-container hidden">\n                <div id="pcsas-programs-grid-container">\n                </div>\n            </div>\n    ';const t=document.getElementById("scrape-pcsas-button"),n=document.getElementById("pcsas-results"),a=document.getElementById("pcsas-programs-grid-container");console.log("pcsasResultsDiv:",n),console.log("pcsasProgramsGridContainer:",a),t&&n&&a&&t.addEventListener("click",()=>o(this,void 0,void 0,function*(){a.innerHTML="<p>Scraping PCSAS data... This may take a moment.</p>",n.classList.remove("hidden"),console.log("pcsasResultsDiv hidden class removed.");try{const e=(yield(0,r.scrapePcsasData)()).programs;if(e&&e.length>0){const t=document.createElement("h3");t.textContent="PCSAS Programs:",n.prepend(t),(0,s.renderCards)(a,e,e=>`\n                            <h4><a href="${e.website}" target="_blank">${(0,s.cleanUniversityName)(e.program_name||"No Name")}</a></h4>\n                            ${e.student_outcomes_link&&e.student_outcomes_link!==e.website?`<p class="small-text"><a href="${e.student_outcomes_link}" target="_blank">Student Outcomes</a></p>`:""}\n                        `,["university-card","card-element"],"university-grid")}else a.innerHTML="<p>No PCSAS programs found.</p>"}catch(e){console.error("Error scraping PCSAS data:",e),a.innerHTML=`<p>Error scraping PCSAS data: ${e.message}. Please try again.</p>`}}))};const r=n(300),s=n(185)}},t={};!function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,n),s.exports}(156)})();